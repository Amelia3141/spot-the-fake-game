<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spot The AI Fake</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #f5f5f5 0%, #e8f5e9 100%); color: #333; padding: 20px; min-height: 100vh; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        h1 { font-size: 32px; margin-bottom: 5px; }
        .subtitle { color: #666; font-size: 14px; }
        .score { text-align: right; }
        .score-label { font-size: 12px; color: #999; }
        .score-value { font-size: 36px; font-weight: bold; }
        .card { background: white; border: 2px solid #4caf50; border-radius: 12px; padding: 30px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .round-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .round-title { font-size: 20px; font-weight: bold; }
        .round-number { background: #4caf50; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; }
        .instructions { color: #666; margin-bottom: 20px; font-size: 14px; }
        .facts { display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; }
        .fact { padding: 20px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; transition: all 0.3s; text-align: left; background: white; }
        .fact:hover:not(.disabled) { border-color: #4caf50; }
        .fact.selected { background: #e8f5e9; border-color: #4caf50; }
        .fact.correct { background: #e8f5e9; border-color: #4caf50; }
        .fact.wrong { background: #ffebee; border-color: #f44336; }
        .fact.disabled { cursor: not-allowed; }
        .fact-name { font-weight: bold; font-size: 16px; margin-bottom: 8px; }
        .fact-desc { font-size: 14px; color: #555; line-height: 1.5; }
        .fact-badge { display: inline-block; margin-top: 10px; padding: 6px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; color: white; }
        .badge-fake { background: #f44336; }
        .badge-real { background: #4caf50; }
        .explanation { background: #f0f7e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-bottom: 20px; display: none; }
        .explanation.show { display: block; }
        .explanation-title { font-weight: bold; margin-bottom: 8px; }
        .explanation-text { font-size: 14px; line-height: 1.6; color: #333; }
        button { background: linear-gradient(135deg, #ff9800 0%, #4caf50 100%); color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; width: 100%; }
        button:hover { transform: translateY(-2px); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .game-over { text-align: center; }
        .final-score { font-size: 64px; font-weight: bold; color: #4caf50; margin: 20px 0; }
        .message { font-size: 18px; margin-bottom: 20px; }
        .lesson { background: #fff3e0; border: 2px solid #ff9800; border-radius: 8px; padding: 15px; margin-top: 20px; font-size: 13px; }
        @media (max-width: 600px) {
            .header { flex-direction: column; text-align: center; }
            .score { margin-top: 15px; }
            h1 { font-size: 24px; }
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="container">
        <div id="game"></div>
    </div>

   <script>
    // Firebase config - replace with YOUR values from Firebase console
    const firebaseConfig = {
        apiKey: "AIzaSyCUdAqlDwN_1lRlbBHaA37RPscAtuxIXTA",
        authDomain: "spot-fake-game.firebaseapp.com",
        databaseURL: "https://spot-fake-game.firebaseio.com",
        projectId: "spot-fake-game",
        storageBucket: "spot-fake-game.firebasestorage.app",
        messagingSenderId: "141455787893",
        appId: "1:141455787893:web:e94feb2716c98336f1753c"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let state = {
        round: 0,
        score: 0,
        selected: null,
        revealed: false,
        complete: false,
        playerName: null,
        leaderboard: []
    };

    const rounds = [
        {
            title: "Round 1: Warming Up",
            facts: [
                { name: "Brain Freeze", desc: "The sharp headache from eating ice cream too fast happens when cold hits the roof of your mouth. Blood vessels rapidly constrict then dilate, triggering pain signals.", fake: false },
                { name: "Exploding Head Syndrome", desc: "People hear loud explosion sounds or crashes inside their head when falling asleep or waking up. It's completely harmless but can be very frightening.", fake: false },
                { name: "Sonic Perception Syndrome", desc: "A rare condition where people can hear electrical frequencies from power lines and WiFi routers, causing constant humming sensations. Affects roughly 2.3% of the population and worsens with age.", fake: true },
                { name: "Hiccups", desc: "Involuntary spasms of the diaphragm muscle followed by sudden closure of the vocal cords. The longest recorded case lasted 68 years.", fake: false }
            ],
            explain: "Sonic Perception Syndrome is AI-generated nonsense. Red flags: suspiciously specific percentage (2.3%), made-up name combining real medical words, no actual mechanism explained."
        },
        {
            title: "Round 2: Getting Tricky",
            facts: [
                { name: "Thunderclap Headache", desc: "A sudden, severe headache that reaches maximum intensity within 60 seconds, often described as 'the worst headache of your life.' Can signal bleeding in the brain.", fake: false },
                { name: "Mirror Touch Synesthesia", desc: "Some people physically feel sensations they see others experiencing. If they watch someone being touched on the arm, they feel it on their own arm.", fake: false },
                { name: "Chromatic Appetite Disorder", desc: "A condition where the brain processes food colors incorrectly, making people unable to eat foods of certain colors. Affects approximately 1 in 8,000 people and is treated with color-filtered glasses.", fake: true },
                { name: "Foreign Accent Syndrome", desc: "After a stroke or head injury, people can suddenly speak with a completely different accent they never had before, like waking up British when you've always been American.", fake: false }
            ],
            explain: "Chromatic Appetite Disorder is fake. Red flags: made-up name using real medical words, oddly specific statistic (1 in 8,000), too-convenient solution."
        },
        {
            title: "Round 3: Expert Level",
            facts: [
                { name: "Cotard Delusion (Walking Corpse Syndrome)", desc: "People believe they are dead, don't exist, or have lost their blood and internal organs. They may refuse to eat because they think they don't need food anymore.", fake: false },
                { name: "Numerical Dysmorphia", desc: "A neurological condition where patients consistently perceive numbers as being exactly 3 units higher than they actually are. First documented in 1987 following a cluster of cases in Norway, with approximately 600 confirmed cases worldwide.", fake: true },
                { name: "Alice in Wonderland Syndrome", desc: "Objects appear much larger or smaller than they really are, and body parts feel like they're changing size. Often affects children and can be triggered by migraines or infections.", fake: false },
                { name: "Capgras Delusion", desc: "People become convinced that someone close to them has been replaced by an identical impostor. They recognize the person's face but feel no emotional connection, creating the certainty that it's an imposter.", fake: false }
            ],
            explain: "Numerical Dysmorphia is AI hallucination. Red flags: too-specific consistent error (always exactly 3 units), suspiciously precise numbers, implausibly neat pattern."
        },
        {
            title: "Round 4: Can You Outsmart AI?",
            facts: [
                { name: "Takotsubo Cardiomyopathy (Broken Heart Syndrome)", desc: "Extreme emotional stress can literally reshape your heart into a balloon-like shape, mimicking a heart attack. Named after Japanese octopus traps because that's what the heart looks like on scans.", fake: false },
                { name: "Hemineglect", desc: "After certain brain injuries, people completely ignore one half of their world. They might only eat food from the right side of their plate, only shave half their face, or only draw half a clock.", fake: false },
                { name: "Prosopagnosia (Face Blindness)", desc: "People cannot recognize faces, even of close family members. Some can't even recognize their own face in a mirror. They have to identify people by voice, clothing, or hairstyle instead.", fake: false },
                { name: "Temporal Sequence Reversal Disorder", desc: "A condition where patients experience short-term memories in reverse chronological order for 15-30 second windows. Caused by disrupted hippocampal timing mechanisms and affects balance and coordination severely.", fake: true }
            ],
            explain: "Temporal Sequence Reversal Disorder is fake. Red flags: suspiciously precise time window, mixing unrelated symptoms, overly technical but meaningless explanation."
        }
    ];

    function selectFact(idx) {
        if (state.revealed) return;
        state.selected = idx;
        const isCorrect = rounds[state.round].facts[idx].fake;
        if (isCorrect) state.score++;
        state.revealed = true;
        render();
    }

    function nextRound() {
        if (state.round < rounds.length - 1) {
            state.round++;
            state.selected = null;
            state.revealed = false;
        } else {
            state.complete = true;
        }
        render();
    }

    function submitScore() {
        const name = document.getElementById('playerNameInput').value.trim();
        if (!name) {
            alert('Please enter your name');
            return;
        }

        const timestamp = new Date().toISOString();
        const entry = {
            name: name,
            score: state.score,
            timestamp: timestamp
        };

        db.ref('scores').push(entry).then(() => {
            state.playerName = name;
            loadLeaderboard();
        });
    }

    function loadLeaderboard() {
        db.ref('scores').orderByChild('score').limitToLast(100).once('value', (snapshot) => {
            const data = snapshot.val();
            state.leaderboard = [];
            if (data) {
                Object.values(data).forEach(entry => {
                    state.leaderboard.push(entry);
                });
            }
            state.leaderboard.sort((a, b) => b.score - a.score);
            render();
        });
    }

    function restart() {
        state = { round: 0, score: 0, selected: null, revealed: false, complete: false, playerName: null, leaderboard: [] };
        render();
    }

    document.addEventListener('keydown', (e) => {
        const key = e.key.toUpperCase();
        if (key === 'A') selectFact(0);
        else if (key === 'B') selectFact(1);
        else if (key === 'C') selectFact(2);
        else if (key === 'D') selectFact(3);
        else if (key === 'ENTER') {
            if (state.revealed && !state.complete) nextRound();
            else if (state.complete) restart();
        }
    });

    function render() {
        const gameEl = document.getElementById('game');

        if (state.complete && !state.playerName) {
            gameEl.innerHTML = `
                <div class="card game-over">
                    <h1>Game Complete!</h1>
                    <div class="final-score">${state.score} / 4</div>
                    <div class="message">
                        ${state.score === 4 ? "Perfect Score! You can spot AI hallucinations like a pro." : 
                          state.score === 3 ? "Excellent Work! You're good at spotting fake medical info." :
                          state.score === 2 ? "Not Bad! AI-generated content can be tricky." :
                          "Keep Learning! AI hallucinations are hard to spot."}
                    </div>
                    <div style="margin: 20px 0;">
                        <input type="text" id="playerNameInput" placeholder="Enter your name" style="padding: 10px; width: 100%; border: 2px solid #4caf50; border-radius: 4px; font-size: 16px;">
                    </div>
                    <button onclick="submitScore()" style="margin-bottom: 10px;">Submit Score</button>
                    <div class="lesson">AI can generate convincing medical information that sounds authoritative but is completely false. Always verify with real sources.</div>
                </div>
            `;
            return;
        }

        if (state.complete && state.playerName) {
            const rank = state.leaderboard.findIndex(e => e.name === state.playerName && e.score === state.score) + 1;
            let leaderboardHtml = '';
            state.leaderboard.slice(0, 10).forEach((entry, idx) => {
                const isPlayer = entry.name === state.playerName && entry.score === state.score;
                leaderboardHtml += `
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: ${isPlayer ? '#fff9c4' : 'white'}; border-bottom: 1px solid #eee;">
                        <span>${idx + 1}. ${entry.name}</span>
                        <span style="font-weight: bold;">${entry.score}/4</span>
                    </div>
                `;
            });

            gameEl.innerHTML = `
                <div class="card game-over">
                    <h1>Game Complete!</h1>
                    <div class="final-score">${state.score} / 4</div>
                    <div class="message" style="font-size: 20px; color: #ff9800;">You ranked #${rank} on the leaderboard!</div>
                    <div style="background: #f5f5f5; border-radius: 8px; padding: 15px; margin: 20px 0;">
                        <div style="font-weight: bold; margin-bottom: 10px;">Top 10 Scores</div>
                        ${leaderboardHtml}
                    </div>
                    <button onclick="restart()">Play Again</button>
                    <div class="lesson">AI can generate convincing medical information that sounds authoritative but is completely false. Always verify with real sources.</div>
                </div>
            `;
            return;
        }

        const round = rounds[state.round];
        let factsHtml = '';
        
        round.facts.forEach((fact, idx) => {
            let classes = 'fact';
            if (state.revealed) {
                if (fact.fake && state.selected === idx) classes += ' correct';
                else if (!fact.fake && state.selected === idx) classes += ' wrong';
                else if (fact.fake) classes += ' wrong';
                classes += ' disabled';
            } else {
                if (state.selected === idx) classes += ' selected';
            }
            
            let badge = '';
            if (state.revealed && fact.fake) {
                badge = state.selected === idx ? '<span class="fact-badge badge-fake">✗ AI-GENERATED FAKE</span>' : '<span class="fact-badge badge-fake">AI FAKE</span>';
            } else if (state.revealed && !fact.fake && state.selected === idx) {
                badge = '<span class="fact-badge badge-real">✓ REAL</span>';
            }
            
            const letter = String.fromCharCode(65 + idx);
            factsHtml += `
                <div class="${classes}" onclick="selectFact(${idx})">
                    <div class="fact-name"><span style="display: inline-block; min-width: 30px; font-weight: bold; color: #ff9800;">${letter}.</span> ${fact.name}</div>
                    <div class="fact-desc">${fact.desc}</div>
                    ${badge}
                </div>
            `;
        });

        let explanation = '';
        if (state.revealed) {
            explanation = `
                <div class="explanation show">
                    <div class="explanation-title">Why was it fake?</div>
                    <div class="explanation-text">${round.explain}</div>
                </div>
            `;
        }

        gameEl.innerHTML = `
            <div class="header">
                <div>
                    <h1>Spot The AI Fake</h1>
                    <p class="subtitle">Can you tell when AI is making stuff up?</p>
                </div>
                <div class="score">
                    <div class="score-label">Score</div>
                    <div class="score-value">${state.score}/4</div>
                </div>
            </div>
            <div class="card">
                <div class="round-info">
                    <div class="round-title">${round.title}</div>
                    <span class="round-number">Round ${state.round + 1}/4</span>
                </div>
                <div class="instructions">3 of these are REAL medical conditions. 1 is completely made up by AI. Which one is fake?</div>
                <div class="instructions" style="font-size: 12px; color: #999;">Press A, B, C, or D on your keyboard to select</div>
                <div class="facts">
                    ${factsHtml}
                </div>
                ${explanation}
                ${state.revealed ? `<button onclick="nextRound()" id="nextBtn">Press Enter or click to continue</button>` : ''}
            </div>
            <div class="lesson">AI can generate convincing medical information that sounds authoritative but is completely false. Always verify with real sources.</div>
        `;
    }

    loadLeaderboard();
    render();
</script>
